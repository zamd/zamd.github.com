---
layout: post
title: Federation over TCP streaming
date: 2008-07-04 02:14:01.000000000 +06:00
type: post
published: true
status: publish
categories:
- Federation/STS
tags: []
meta:
  _oembed_372c16ac4b85341f30f246f5739e5756: '{{unknown}}'
author:
  login: zamd
  email: zulfiqar.ahmed@gmail.com
  display_name: zamd
  first_name: ''
  last_name: ''
---
<div class="Section1">
<p class="MsoNormal">Pablo described <a href="http://weblogs.asp.net/cibrax/archive/2008/04/21/federation-over-tcp-with-wcf.aspx">here</a> a way to configure federation over TCP. In his approach he gets a SAML token from STS and then uses that token to get a security context token which will be used to provide actual message security throughout the session.</p>
<p class="MsoNormal">As message security only works in a buffered mode, so his approach is not suitable for a TCP streaming scenario. To enable federation along with TCP streaming you have to use mixed mode security (TransportWithMessageCredential) over TCP. &nbsp;Let&#8217;s consider following binding which uses mixed mode security.</p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">netTcpBinding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">binding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">name</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">tcp</span>&quot;<span style="color:blue;"> </span><span style="color:red;">transferMode</span><span style="color:blue;">=</span>&quot;<span style="color:blue;">Streamed</span>&quot;<span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">security</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">mode</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">TransportWithMessageCredential</span>&quot;<span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">message</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">clientCredentialType</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">IssuedToken</span>&quot;<span style="color:blue;">/&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">transport</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">clientCredentialType</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">Windows</span>&quot;<span style="color:blue;">&gt;&lt;/</span><span style="color:#A31515;">transport</span><span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">security</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">binding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">netTcpBinding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"></span></p>
<p class="MsoNormal">Now the trouble is that there is no way to configure STS settings in this binding configuration so your only choice is to mimic the above settings in a custom binding. </p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">wsHttpBinding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">binding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">name</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">simpTransport</span>&quot;<span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">security</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">mode</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">Transport</span>&quot;<span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">transport</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">clientCredentialType</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">None</span>&quot;<span style="color:blue;">/&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">security</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">binding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">wsHttpBinding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">customBinding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">binding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">name</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">tcp</span>&quot;<span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">security</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">authenticationMode</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">SecureConversation</span>&quot;<span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">secureConversationBootstrap</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">authenticationMode</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">IssuedTokenOverTransport</span>&quot;<span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">issuedTokenParameters</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">issuer</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;">address</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">=</span><span style="font-size:10pt;font-family:\"Courier New\";">&quot;<span style="color:blue;">https://localhost:9000/STS</span>&quot;<span style="color:blue;"> </span><span style="color:red;">binding</span><span style="color:blue;">=</span>&quot;<span style="color:blue;">wsHttpBinding</span>&quot;<span style="color:blue;"> </span><span style="color:red;">bindingConfiguration</span><span style="color:blue;">=</span>&quot;<span style="color:blue;">simpTransport</span>&quot;<span style="color:blue;">/&gt;</span></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">issuedTokenParameters</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">secureConversationBootstrap</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">security</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="background:aqua;">&lt;</span></span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;background:aqua;">windowsStreamSecurity</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;background:aqua;">/&gt;</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="background:yellow;">&lt;</span></span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;background:yellow;">tcpTransport</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;background:yellow;"> </span><span style="font-size:10pt;font-family:\"Courier New\";color:red;background:yellow;">transferMode</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;background:yellow;">=</span><span style="font-size:10pt;font-family:\"Courier New\";background:yellow;">&quot;<span style="color:blue;">Streamed</span>&quot;<span style="color:blue;"> /&gt;</span></span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;"></span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">binding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
<p class="MsoNormal"><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/</span><span style="font-size:10pt;font-family:\"Courier New\";color:#A31515;">customBinding</span><span style="font-size:10pt;font-family:\"Courier New\";color:blue;">&gt;</span></p>
</p></div>
